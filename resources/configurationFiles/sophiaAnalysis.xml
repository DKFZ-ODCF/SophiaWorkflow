<configuration name='sophiaAnalysis' description=''
               configurationType='analysis' class='de.dkfz.roddy.core.Analysis'
               workflowClass='de.dkfz.b080.co.sophiaworkflow.SophiaWorkflow'
               runtimeServiceClass='de.dkfz.b080.co.common.BasicCOProjectsRuntimeService'
               listOfUsedTools=""
               usedToolFolders="sophiaworkflow,tools"
               cleanupScript="cleanupScript">
    <configurationvalues>
        <!-- ## Imported from cofilenames -->
        <cvalue name='sampleDirectory' value='${inputBaseDirectory}/${pid}/${sample}/${library}/${SEQUENCER_PROTOCOL}' type='path'/>
        <cvalue name='sequenceDirectory' value='${sampleDirectory}/${run}/sequence' type='path'/>
        <cvalue name='mergedBamSuffix_markDuplicatesShort' value='merged.mdup.bam' type="string"/>
        <cvalue name='mergedBamSuffixList' value='${mergedBamSuffix_markDuplicatesShort}' type="string" description="A list of all known suffixes for merged bam files. I.e. merged.dupmark.bam, merged.mdup.bam..."/>
        <cvalue name='defaultMergedBamSuffix' value='${mergedBamSuffix_markDuplicatesShort}' type="string" description="The default suffix for merged bam files when they are created by Roddy."/>

        <!-- ## Imported from cobase project -->
        <cvalue name='possibleControlSampleNamePrefixes' value='( blood BLOOD normal control CONTROL buffy_coat GERMLINE )' type='bashArray'/>
        <cvalue name='possibleTumorSampleNamePrefixes' value='( tumor TUMOR metastasis xenograft disease DISEASE relapse RELAPSE autopsy AUTOPSY metastasis METASTASIS )' type='bashArray'/>
        <cvalue name='possibleSingleCellSampleNamePrefixes' value='( SingleCell single_cell )' type='bashArray'/>
        <cvalue name="useCentralAnalysisArchive" value="true"/>
        <cvalue name="enableJobProfiling" value="false"/>
        <cvalue name='QUAL' value='phred' description="Default quality is phred, can be illumina."/>

        <!-- ## Imported from commonCOWorkflowsSettings -->
        <cvalue name='SEQUENCER_PROTOCOL' value='paired' type="string" description="only paired read sequencing is currently supported"/>

        <!-- ## DIRECTORIES -->
        <cvalue name='alignmentOutputDirectory' value='alignment' type='string'/>
        <cvalue name='insertSizesOutputDirectory' value='insertsize_distribution'/>
        <cvalue name='qcOutputDirectory' value='qualitycontrol' type='string'/>
        <cvalue name='sophiaOutputDirectory' value='SOPHIA' type='string'/>
        <cvalue name='ALIGNMENT_DIR' value='${outputAnalysisBaseDirectory}/${alignmentOutputDirectory}' type='string'/>
        <cvalue name='SOPHIA_DIR' value='${outputAnalysisBaseDirectory}/${sophiaOutputDirectory}' type='string'/>

        <!-- Binaries -->
        <cvalue name='version' value='v34' type='string' />
        <cvalue name='BINARIES_BASE' value='/icgc/dkfzlsdf/analysis/B080/toprak/public/sophiaDist/' type='string' />
        <cvalue name="RSCRIPT_BINARY" value="Rscript-3.0.0"/>
        <cvalue name="SOPHIA_BINARY" value="${BINARIES_BASE}/sophia_${version}"/>
        <cvalue name="SOPHIA_ANNOTATION_BINARY" value="${BINARIES_BASE}/sophiaAnnotate/sophiaAnnotate"/>
        <cvalue name="SAMTOOLS_BINARY" value="samtools-1.2"/>
        <cvalue name="MBUFFER_BINARY" value="mbuffer"/>
        <cvalue name="GZIP_BINARY" value="gzip"/>
        <cvalue name="BEDTOOLS_BINARY" value="bedtools-2.24.0"/>
        <cvalue name="PYTHON_BINARY" value="python3"/>

        <!-- ## Default file acces -->
        <cvalue name='outputFileGroup' value='B080'/>
        <cvalue name='outputUMask' value='007' type='string'/>
        <cvalue name='outputAccessRights' value='u+rw,g+rw,o-rwx'/>
        <cvalue name='outputAccessRightsForDirectories' value='u+rwx,g+rwx,o-rwx'/>
        <cvalue name='outputAllowAccessRightsModification' value='false' type="boolean"/>

        <!-- Sophia specific values -->
        <cvalue name="project" value="" description="Was used as an input parameter for the annotator"/>
        <cvalue name="versionSuffix" value="1.1.1" description=""/>
        <cvalue name="standardHeader" value='"#chrom1\tstart1\tend1\tchrom2\tstart2\tend2\tsomaticity1\tsomaticity2\tsvtype\teventScore\teventSize\teventInversion\tevidence1\tclonalityRatio1\tevidence2\tclonalityRatio2\tsource1\tsource2\tgene1\tnearestGeneUpstream1\tnearestGeneUpstreamDistance1\tnearestGeneDownstream1\tnearestGeneownstreamDistance1\tgene2\tnearestGeneUpstream2\tnearestGeneUpstreamDistance2\tnearestGeneDownstream2\tnearestGeneownstreamDistance2"' description=""/>

        <cvalue name='mergedRef' value='${BINARIES_BASE}/hg19_WholeGenome_merged_NOMT.bed' type='string' />
        <cvalue name='mapqThreshold' value='13' type='string' />
        <cvalue name='clipThreshold' value='10' type='string' />
        <cvalue name='qualThreshold' value='23' type='string' />
        <cvalue name='qualThresholdLow' value='12' type='string' />
        <cvalue name='lowQualOverhangThreshold' value='5' type='string' />
        <cvalue name='isizeSigmaThreshold' value='5' type='string' />
        <cvalue name='bpSupportThreshold' value='3' type='string' />
        <cvalue name='defaultReadLength' value='151' type='string' />

        <cvalue name='refFolder' value='${annotationPipelineDir}/annotationMaterials/' type='string' />
        <cvalue name='geneRefBed' value='${refFolder}/gencode.v19.annotation_plain.genes_collapsed_sorted_filtered_coding.bed.gz' type='string' />
        <cvalue name='intronExonRefBed' value='${refFolder}/gencode.v19.annotation_plain.exons_introns.sorted_uniq_collapsed_sorted_filtered.bed.gz' type='string' />
        <cvalue name='chromSizesRef' value='${refFolder}/hg19_chromSizes_withContigsDecoys.genome' type='string' />
        <cvalue name='pidsInMref' value='1747' type='string' />
        <cvalue name='mRef' value='${refFolder}/mergedMref_${version}_${pidsInMref}_mergedBpCounts.bed.gz' type='string' />
        <cvalue name='artifactLoFreq' value='33' type='string' />
        <cvalue name='artifactHiFreq' value='66' type='string' />
        <cvalue name='clonalityLoFreq' value='5' type='string' />
        <cvalue name='clonalityStrictLoFreq' value='20' type='string' />
        <cvalue name='clonalityHiFreq' value='85' type='string' />
        <cvalue name='bpFreq' value='5' type='string' />
        <cvalue name='germlineFuzziness' value='2' type='string' />
        <cvalue name='germlineDbLimit' value='5' type='string' />
        <cvalue name='version' value='v34' type='string' />
        <cvalue name='versionSuffix' value='${version}' type='string' />
        <!--<cvalue name='versionSuffix' value='${projectName}_${version}' type='string' description="This is the original value" />-->



    </configurationvalues>
    <processingTools>
        <tool name="circlizeScript" value="circlizeEvents.R" basepath="sophiaworkflow"/>
        <tool name="sophiaAnnotateCoordinateCorrection" value="sophiaAnnotateCoordinateCorrection.py" basepath="sophiaworkflow"/>

        <tool name="sophia" value="sophiaCalling.sh" basepath="sophiaworkflow">
            <resourcesets>
                <rset size="s" memory="1g" cores="2" nodes="1" walltime="3h" queue="devel"/>
                <rset size="l" memory="1g" cores="2" nodes="1" walltime="120h"/>
            </resourcesets>
            <input type="file" typeof="BasicBamFile" scriptparameter="BAMFILE"/>
            <input type="file" typeof="InsertSizesValueFile" scriptparameter="mergedIsizes"/>
            <output type="file" typeof="SophiaOutputBedpe" scriptparameter="FILENAME_OUT"/>
        </tool>

        <tool name="sophiaAnnotatorNoControl" value="sophiaAnnotateAbridgedCaller.sh" basepath="sophiaworkflow">
            <resourcesets>
                <rset size="s" memory="1g" cores="1" nodes="1" walltime="1h" queue="devel"/>
                <rset size="l" memory="4g" cores="1" nodes="1" walltime="8h"/>
            </resourcesets>
            <input type="file" typeof="SophiaOutputBedpe" scriptparameter="tumorFile"/>
            <output type="tuple">
                <output type="file" typeof="AnnotationAbridgedFile" scriptparameter="BEDPE_RESULT_FILE_ANNOTATED_ABRIDGED"/>
                <output type="file" typeof="AnnotationAbridgedContextFile" scriptparameter="BEDPE_RESULT_FILE_ANNOTATED_ABRIDGED_CONTEXT"/>
                <output type="file" typeof="AnnotationGermlineStrictFile" scriptparameter="BEDPE_RESULT_FILE"/>
                <output type="file" typeof="AnnotationFilteredBedpeFile" scriptparameter="BEDPE_RESULT_FILE_FILTERED"/>
                <output type="file" typeof="AnnotationFilteredSomaticBedpeFile" scriptparameter="BEDPE_RESULT_FILE_FILTERED_SOMATIC"/>
            </output>
        </tool>
        <tool name="sophiaAnnotator" value="sophiaAnnotateAbridgedCaller.sh" basepath="sophiaworkflow">
            <resourcesets>
                <rset size="s" memory="1g" cores="1" nodes="1" walltime="1h" queue="devel"/>
                <rset size="l" memory="4g" cores="1" nodes="1" walltime="8h"/>
            </resourcesets>
            <input type="file" typeof="SophiaOutputBedpe" scriptparameter="bloodFile"/>
            <input type="file" typeof="SophiaOutputBedpe" scriptparameter="tumorFile"/>
            <output type="tuple">
                <output type="file" typeof="AnnotationAbridgedFile" scriptparameter="BEDPE_RESULT_FILE_ANNOTATED_ABRIDGED"/>
                <output type="file" typeof="AnnotationAbridgedContextFile" scriptparameter="BEDPE_RESULT_FILE_ANNOTATED_ABRIDGED_CONTEXT"/>
                <output type="file" typeof="AnnotationGermlineStrictFile" scriptparameter="BEDPE_RESULT_FILE"/>
                <output type="file" typeof="AnnotationFilteredBedpeFile" scriptparameter="BEDPE_RESULT_FILE_FILTERED"/>
                <output type="file" typeof="AnnotationFilteredSomaticBedpeFile" scriptparameter="BEDPE_RESULT_FILE_FILTERED_SOMATIC"/>
            </output>
        </tool>
    </processingTools>
    <filenames package='de.dkfz.b080.co.files' filestagesbase='de.dkfz.b080.co.files.COFileStage'>
        <filename class='SophiaOutputBedpe' derivedFrom="BasicBamFile" pattern='${outputAnalysisBaseDirectory}/${sophiaOutputDirectory}/${sample}_${pid}_${cvalue,name="versionSuffix"}_bps.bed.gz'/>
        <filename class='AnnotationAbridgedFile' derivedFrom='SophiaOutputBedpe' pattern='${sourcefileAtomicPrefix,delimiter=".bed.gz"}_annotatedAbridged.bedpe'/>
        <filename class='AnnotationAbridgedContextFile' derivedFrom='SophiaOutputBedpe' pattern='${sourcefileAtomicPrefix,delimiter=".bed.gz"}_annotatedAbridgedContext.bedpe'/>
        <filename class='AnnotationGermlineStrictFile' derivedFrom='SophiaOutputBedpe' pattern='${sourcefileAtomicPrefix,delimiter=".bed.gz"}_annotatedAbridged_${cvalue,name="analysisTag"}_filtered_germlineStrict.bedpe'/>
        <filename class='AnnotationFilteredBedpeFile' derivedFrom='SophiaOutputBedpe' pattern='${sourcefileAtomicPrefix,delimiter=".bed.gz"}_annotatedAbridged_${cvalue,name="analysisTag"}_filtered.bedpe'/>
        <filename class='AnnotationFilteredSomaticBedpeFile' derivedFrom='SophiaOutputBedpe' pattern='${sourcefileAtomicPrefix,delimiter=".bed.gz"}_annotatedAbridged_${cvalue,name="analysisTag"}_filtered_somatic.bedpe'/>
        <filename class='InsertSizesValueFile' derivedFrom='BasicBamFile' pattern='${outputAnalysisBaseDirectory}/${insertSizesOutputDirectory}/${sourcefileAtomicPrefix,delimiter="_"}_insertsize_plot.png_qcValues.txt'/>
    </filenames>
</configuration>
